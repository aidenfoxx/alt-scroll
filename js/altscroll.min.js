/** 
 * Alternate Scroll
 * 
 * @version    0.2.1
 * @author     Aiden Foxx
 * @license    MIT License 
 * @copyright  2015 Aiden Foxx
 * @link       http://github.com/aidenfoxx
 * @twitter    @furiousfoxx
 */ 
function AltScroll(a,b){if(!(this instanceof AltScroll))return new AltScroll(a,b);this.container=a;this.content=a.children[0];this.scrollbarSize=this.calcScrollbarSize();this.dragBegin=this.dragEvent=this.dragStartEvent=this.scrollEvent=this.scrollTimeout=this.scrollFrame=null;this.dragInitVec={x:0,y:0};this.dragInitMouseVec={x:0,y:0};this.childRect=this.contentRect=this.containerRect=this.snapTimeout=this.resizeTimeout=null;this.options={snap:!1,snapSpeed:300,scrollLock:!1,scrollLockThreshold:20,
momentum:!0,momentumFalloff:.006};for(var c in b)this.options[c]=b[c];this.hideScrollbars();this.resizeCallback();this.bindEvents()}AltScroll.prototype.calcRelativePos=function(a,b){return{x:a-this.containerRect.left,y:b-this.containerRect.top}};AltScroll.prototype.calcTouchCoords=function(a){return this.calcRelativePos(a.changedTouches?a.changedTouches[0].pageX:a.pageX,a.changedTouches?a.changedTouches[0].pageY:a.pageY)};
AltScroll.prototype.clacPointDistance=function(a,b){var c=b.x-a.x,d=b.y-a.y;return Math.sqrt(c*c+d*d)};AltScroll.prototype.calcNearestChild=function(){for(var a=null,b=0,c=0,d=this.childRect.length;c<d;c++){var e=this.calcRelativePos(this.childRect[c].left,this.childRect[c].top),e=this.clacPointDistance({x:this.container.scrollLeft,y:this.container.scrollTop},e);if(!c||e<a)a=e,b=c}return b};
AltScroll.prototype.calcScrollbarSize=function(){var a=document.createElement("div"),b=document.createElement("div");b.style.width="100%";a.style.width="100px";a.style.overflowY="scroll";a.appendChild(b);document.body.appendChild(a);b=100-b.offsetWidth;a.parentNode.removeChild(a);return b};
AltScroll.prototype.getChildRect=function(){var a=[],b=this.container.scrollTop,c=this.container.scrollLeft;this.container.scrollTop=0;for(var d=this.container.scrollLeft=0,e=this.content.children.length;d<e;d++)a.push(this.content.children[d].getBoundingClientRect());this.container.scrollTop=b;this.container.scrollLeft=c;return a};
AltScroll.prototype.hideScrollbars=function(){var a=this.container.parentElement;-1<a.className.indexOf("hide-scroll")&&(this.container.style.width=a.offsetWidth+this.scrollbarSize+"px",this.container.style.height=a.offsetHeight+this.scrollbarSize+"px")};
AltScroll.prototype.bindEvents=function(){this.dragStartEvent=this.dragStart.bind(this);"ontouchstart"in window?(this.container.addEventListener("touchstart",this.touchStart.bind(this)),window.addEventListener("touchend",this.touchEnd.bind(this)),window.addEventListener("touchcancel",this.touchEnd.bind(this))):0<navigator.maxTouchPoints?(this.container.addEventListener("pointerdown",this.touchStart.bind(this)),window.addEventListener("pointerout",this.touchEnd.bind(this))):0<navigator.msMaxTouchPoints&&
(this.container.addEventListener("MSPointerDown",this.touchStart.bind(this)),window.addEventListener("MSPointerOut",this.touchEnd.bind(this)));this.container.addEventListener("mousedown",this.dragStartEvent);window.addEventListener("mouseup",this.dragEnd.bind(this));window.addEventListener("resize",this.resize.bind(this));this.options.snap?(this.container.addEventListener("mousewheel",this.snapDelay.bind(this)),this.container.addEventListener("DOMMouseScroll",this.snapDelay.bind(this))):(this.container.addEventListener("mousewheel",
this.scrollStop.bind(this)),this.container.addEventListener("DOMMouseScroll",this.scrollStop.bind(this)))};AltScroll.prototype.resize=function(){clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout(function(){this.resizeCallback()}.bind(this),500)};AltScroll.prototype.resizeCallback=function(){this.hideScrollbars();this.containerRect=this.container.getBoundingClientRect();this.contentRect=this.content.getBoundingClientRect();this.childRect=this.getChildRect()};
AltScroll.prototype.scrollTo=function(a,b,c,d,e){var h=this.contentRect.width-this.containerRect.width+this.scrollbarSize,k=this.contentRect.height-this.containerRect.height+this.scrollbarSize;if(0>a||a>h){var f=a-this.container.scrollLeft;a=0>a?0:h;f=Math.abs(a-this.container.scrollLeft)/Math.abs(f)}if(0>b||b>k){h=b-this.container.scrollTop;b=0>b?0:k;var g=Math.abs(b-this.container.scrollTop)/Math.abs(h)}!f&&g?c*=g:f&&!g?c*=f:f&&g&&(c*=f<g?f:g);this.scrollStop();this.scrollFrame=window.requestAnimationFrame(function(){this.scrollToFrame(Date.now(),
this.container.scrollLeft,a,this.container.scrollTop,b,c,d,e)}.bind(this))};AltScroll.prototype.scrollToFrame=function(a,b,c,d,e,h,k,f){if(0<h){var g=(Date.now()-a)/h;if(1>g){this.container.scrollLeft=Math.round(b+(c-b)*(k?k(g):g));this.container.scrollTop=Math.round(d+(e-d)*(k?k(g):g));this.scrollFrame=window.requestAnimationFrame(function(){this.scrollToFrame(a,b,c,d,e,h,k,f)}.bind(this));return}}this.container.scrollLeft=Math.round(c);this.container.scrollTop=Math.round(e);f&&f.bind(this)()};
AltScroll.prototype.scrollStop=function(){window.cancelAnimationFrame(this.scrollFrame)};AltScroll.prototype.snapTo=function(a,b,c,d){if(!this.childRect[a])return!1;a=this.calcRelativePos(this.childRect[a].left,this.childRect[a].top);this.scrollTo(a.x,a.y,0<=b?b:this.options.snapSpeed,"object"===typeof EasingFunctions?EasingFunctions.easeOutCubic:c,d)};AltScroll.prototype.snapToNearest=function(a,b,c){return this.snapTo(this.calcNearestChild(),a,b,c)};
AltScroll.prototype.snapDelay=function(){this.scrollStop();clearTimeout(this.snapTimeout);this.snapTimeout=setTimeout(function(){this.container.removeEventListener("scroll",this.scrollEvent);this.scrollEvent=null;this.snapToNearest()}.bind(this),500);this.scrollEvent||(this.scrollEvent=function(){this.snapDelay()}.bind(this),this.container.addEventListener("scroll",this.scrollEvent))};
AltScroll.prototype.touchStart=function(a){!this.dragStartEvent||a.pointerType&&"touch"!==a.pointerType||(this.container.removeEventListener("mousedown",this.dragStartEvent),this.dragStartEvent=null,this.scrollStop())};AltScroll.prototype.touchEnd=function(a){this.dragStartEvent||a.pointerType&&"touch"!==a.pointerType||(setTimeout(function(){this.dragStartEvent=this.dragStart.bind(this);this.container.addEventListener("mousedown",this.dragStartEvent)}.bind(this),1E3),this.options.snap&&this.snapDelay())};
AltScroll.prototype.dragStart=function(a){a.preventDefault();this.scrollStop();this.dragEvent||(this.dragBegin=Date.now(),this.dragInitMouseVec=this.calcTouchCoords(a),this.dragInitVec={x:this.container.scrollLeft,y:this.container.scrollTop},this.dragEvent=this.drag.bind(this),this.container.addEventListener("mousemove",this.dragEvent))};
AltScroll.prototype.drag=function(a){a=this.calcTouchCoords(a);this.scrollTo(this.dragInitVec.x+(this.dragInitMouseVec.x-a.x),this.dragInitVec.y+(this.dragInitMouseVec.y-a.y),0)};
AltScroll.prototype.dragEnd=function(a){if(this.dragEvent){window.cancelAnimationFrame(this.scrollFrame);if(this.options.momentum){var b=this.calcTouchCoords(a),c=Date.now()-this.dragBegin;a=(this.dragInitMouseVec.x-b.x)/c;b=(this.dragInitMouseVec.y-b.y)/c;this.scrollTo(this.container.scrollLeft+Math.abs(a)*a/(2*this.options.momentumFalloff),this.container.scrollTop+Math.abs(b)*b/(2*this.options.momentumFalloff),Math.abs(Math.abs(a)>Math.abs(b)?a:b)/this.options.momentumFalloff,"object"===typeof EasingFunctions?
EasingFunctions.easeOutCubic:null,this.options.snap?this.snapToNearest:null)}else this.options.snap&&this.snapToNearest();this.container.removeEventListener("mousemove",this.dragEvent);this.dragEvent=null}};