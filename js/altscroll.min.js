/** 
 * Alternate Scroll
 * 
 * @version    0.1.0
 * @author     Aiden Foxx
 * @license    MIT License 
 * @copyright  2015 Aiden Foxx
 * @link       http://github.com/aidenfoxx
 * @twitter    @furiousfoxx
 */ 
function AltScroll(a,b){if(!(this instanceof AltScroll))return new AltScroll(a,b);this.container=a;this.content=a.children[0];this.scrollbarSize=this.calcScrollbarSize();this.dragBegin=this.dragEvent=this.scrollFrame=this.scrollEvent=null;this.scrollInitVec={x:0,y:0};this.scrollInitMouseVec={x:0,y:0};this.snapTimeout=this.resizeTimeout=null;this.options={snap:!1,snapSpeed:300,momentum:!0,momentumFalloff:.006};for(var c in b)this.options[c]=b[c];this.hideScrollbars();this.containerRect=this.container.getBoundingClientRect();
this.contentRect=this.content.getBoundingClientRect();this.childRect=this.getChildRect();this.bindEvents()}AltScroll.prototype.calcRelativePos=function(a,b){return{x:a-this.containerRect.left,y:b-this.containerRect.top}};AltScroll.prototype.calcTouchCoords=function(a){return this.calcRelativePos(a.changedTouches?a.changedTouches[0].pageX:a.pageX,a.changedTouches?a.changedTouches[0].pageY:a.pageY)};AltScroll.prototype.clacPointDistance=function(a,b){var c=b.x-a.x,e=b.y-a.y;return Math.sqrt(c*c+e*e)};
AltScroll.prototype.calcNearestChild=function(){for(var a=null,b=0,c=0,e=this.childRect.length;c<e;c++){var d=this.calcRelativePos(this.childRect[c].left,this.childRect[c].top),d=this.clacPointDistance({x:this.container.scrollLeft,y:this.container.scrollTop},d);if(!c||d<a)a=d,b=c}return b};
AltScroll.prototype.calcScrollbarSize=function(){var a=document.createElement("div"),b=document.createElement("div");b.style.width="100%";a.style.width="100px";a.style.overflowY="scroll";a.appendChild(b);document.body.appendChild(a);b=100-b.offsetWidth;a.parentNode.removeChild(a);return b};
AltScroll.prototype.getChildRect=function(){var a=[],b=this.container.scrollTop,c=this.container.scrollLeft;this.container.scrollTop=0;for(var e=this.container.scrollLeft=0,d=this.content.children.length;e<d;e++)a.push(this.content.children[e].getBoundingClientRect());this.container.scrollTop=b;this.container.scrollLeft=c;return a};
AltScroll.prototype.hideScrollbars=function(){var a=this.container.parentElement;"hide-scroll"===a.className&&(this.container.style.width=a.offsetWidth+this.scrollbarSize+"px",this.container.style.height=a.offsetHeight+this.scrollbarSize+"px")};
AltScroll.prototype.bindEvents=function(){this.scrollEvent=this.scroll.bind(this);this.container.addEventListener("scroll",this.scrollEvent);this.container.addEventListener("mousedown",this.dragStart.bind(this));window.addEventListener("mouseup",this.dragEnd.bind(this));window.addEventListener("resize",this.resize.bind(this))};
AltScroll.prototype.resize=function(){clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout(function(){this.hideScrollbars();this.containerRect=this.container.getBoundingClientRect();this.contentRect=this.content.getBoundingClientRect();this.childRect=this.getChildRect()}.bind(this),500)};
AltScroll.prototype.scrollTo=function(a,b,c,e){var d=this.contentRect.width-this.containerRect.width+this.scrollbarSize,h=this.contentRect.height-this.containerRect.height+this.scrollbarSize;if(0<d&&(0>a||a>d)){var f=a-this.container.scrollLeft;a=0>a?0:d;f=Math.abs(a-this.container.scrollLeft)/Math.abs(f)}if(0<h&&(0>b||b>h)){d=b-this.container.scrollTop;b=0>b?0:h;var g=Math.abs(b-this.container.scrollTop)/Math.abs(d)}!f&&g?c*=g:f&&!g?c*=f:f&&g&&(c*=f<g?f:g);window.cancelAnimationFrame(this.scrollFrame);
this.scrollFrame=window.requestAnimationFrame(function(){this.scrollToFrame(Date.now(),this.container.scrollLeft,a,this.container.scrollTop,b,c,e)}.bind(this))};
AltScroll.prototype.scrollToFrame=function(a,b,c,e,d,h,f){if(0<h){var g=(Date.now()-a)/h;if(1>g){this.container.scrollLeft=Math.round(b+(c-b)*(f?f(g):g));this.container.scrollTop=Math.round(e+(d-e)*(f?f(g):g));this.scrollFrame=window.requestAnimationFrame(function(){this.scrollToFrame(a,b,c,e,d,h,f)}.bind(this));return}}this.container.scrollLeft=Math.round(c);this.container.scrollTop=Math.round(d);this.scrollEnd()};
AltScroll.prototype.scrollEnd=function(){this.scrollEvent||(this.scrollEvent=this.scroll.bind(this),this.container.addEventListener("scroll",this.scrollEvent))};AltScroll.prototype.snapTo=function(a,b,c){if(!this.childRect[a])return!1;a=this.calcRelativePos(this.childRect[a].left,this.childRect[a].top);this.scrollTo(a.x,a.y,0<=b?b:this.options.snapSpeed,"object"===typeof EasingFunctions?EasingFunctions.easeOutCubic:c)};
AltScroll.prototype.snapToNearest=function(a,b){return this.snapTo(this.calcNearestChild(),a,b)};AltScroll.prototype.scroll=function(a){this.options.snap&&(clearTimeout(this.snapTimeout),this.snapTimeout=setTimeout(function(){this.container.removeEventListener("scroll",this.scrollEvent);this.scrollEvent=null;this.snapToNearest()}.bind(this),500))};
AltScroll.prototype.dragStart=function(a){a.preventDefault();this.dragEvent||(this.scrollBegin=Date.now(),this.scrollInitMouseVec=this.calcTouchCoords(a),this.scrollInitVec={x:this.container.scrollLeft,y:this.container.scrollTop},this.dragEvent=this.drag.bind(this),this.container.addEventListener("mousemove",this.dragEvent))};
AltScroll.prototype.drag=function(a){a.preventDefault();a=this.calcTouchCoords(a);this.scrollTo(this.scrollInitVec.x+(this.scrollInitMouseVec.x-a.x),this.scrollInitVec.y+(this.scrollInitMouseVec.y-a.y),0)};
AltScroll.prototype.dragEnd=function(a){if(this.dragEvent){window.cancelAnimationFrame(this.scrollFrame);if(this.options.momentum){var b=this.calcTouchCoords(a),c=Date.now()-this.scrollBegin;a=(this.scrollInitMouseVec.x-b.x)/c;b=(this.scrollInitMouseVec.y-b.y)/c;this.scrollTo(this.container.scrollLeft+Math.abs(a)*a/(2*this.options.momentumFalloff),this.container.scrollTop+Math.abs(b)*b/(2*this.options.momentumFalloff),Math.abs(Math.abs(a)>Math.abs(b)?a:b)/this.options.momentumFalloff,"object"===typeof EasingFunctions?
EasingFunctions.easeOutCubic:null)}this.container.removeEventListener("mousemove",this.dragEvent);this.dragEvent=null}};